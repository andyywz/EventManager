<h1 class="big-title">
	This Week in Swing NYC - <%= DateTime.now.strftime('%b %d %Y') %>
</h1>

<li>
	<a id="new-event-button" href="#">New Event</a>
	
	<div class="new-event hide">
		<%= render partial: "events/new" %>
	</div>
</li>


<section class="reccurring">
	<h1 class="medium-title">
		Weekly Events
	</h1>
	
	<% @reccurring_events.each do |o| %>
		<h2 class="event-name">
			<%= o.event.name %> --- 
				<time class="event-time">
					<%= o.event_time.strftime('%a') %>
					<%= o.event_time.strftime('%I:%M %p') %>
				</time>
		</h2>

		<div class="event-content hide">
			
			<label>Venue: <%= o.event.place %></label>
			
			<label>Cover: <%= o.event.cover %></label>

			<label>Age Limit: <%= o.event.age_limit %></label>

			<label>Music: <%= o.event.music %></label>

			<label>Floor: <%= o.event.floor %></label>

			<label>ETC: 
				<div class="etc">
					<%= o.event.body %>
				</div>
			</label>

		</div>
	<% end %>
	
</section>

<section class="special">
	<h1 class="medium-title">
		Special Events
	</h1>
	<% @events.each do |o| %>
		<h2 class="event-name">
			<%= o.event.name %> --- 
				<time class="event-time">
					<%= o.event_time.strftime('%a') %>
					<%= o.event_time.strftime('%I:%M %p') %>
				</time>
		</h2>
		
		<div class="event-content hide">
		
			<label>Venue: <%= o.event.place %></label>
		
			<label>Cover: <%= o.event.cover %></label>

			<label>Age Limit: <%= o.event.age_limit %></label>

			<label>Music: <%= o.event.music %></label>

			<label>Floor: <%= o.event.floor %></label>

			<label>ETC: 
				<div class="etc">
					<%= o.event.body %>
				</div>
			</label>

		</div>
	<% end %>
</section>

<script>

$(document).ready(function () {	
	$("#event-form").find('input[type="submit"]').on(
		"click",
		function (event) {
		  event.preventDefault();
	
		  var formData = $(this.form).serialize();
	
			var time = $(this.form).find("#occurrence_time").val();
			var date = $(this.form).find("#occurrence_time").val();
	
			if (time !== "" && date !== "") {
		    $.ajax({
		      url: "/events.json",
		      type: "POST",
		      data: formData,
		      success: function (eventData) {
						if (eventData["reccurring"] == true) {
							
							temp = $(".reccurring .event-time").get();
								$(".reccurring .event-time").each(function (index, domEl) {
									datetime = $(domEl).html().trim().split(/\s+/);
								})
								
						} else {
							
							temp = $(".reccurring .event-time").get();
							$(".reccurring .event-time").each(function (index, domEl) {
								datetime = $(domEl).html().trim().split(/\s+/);
							})
		
						};
		      }
		    });
			} else {
				console.log("You missed a field")
			};
		}
	);
		
});
</script>